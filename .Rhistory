if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
NULL
}
})
# --- 3. Create Individual Plots for Each Image ---
plot_list <- list(
daily_extreme = ggplot() +
annotation_custom(rasterGrob(imgs[[1]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void(),
daily_normal = ggplot() +
annotation_custom(rasterGrob(imgs[[2]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void(),
weekly_extreme = ggplot() +
annotation_custom(rasterGrob(imgs[[3]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void(),
weekly_normal = ggplot() +
annotation_custom(rasterGrob(imgs[[4]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void()
)
# --- 4. Combine Using Patchwork in 2x2 Grid ---
combined_plot <- (plot_list[[1]] | plot_list[[2]]) /
(plot_list[[3]] | plot_list[[4]])
# --- 5. Save the Combined Plot ---
ggsave(
filename = "SHAP_facet_grid_no_labels.png",
plot = combined_plot,
width = 10,
height = 10,
dpi = 300,
units = "in"
)
print(combined_plot)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(tibble)
library(png)
library(grid)
library(patchwork)
#| fig-dpi: 300
#| fig-width: 14
#| fig-height: 8
#| warning: false
# --- 1. Define Image Files ---
img_paths <- c(
"notebooks/images/SHAP2/beeswarm_heat.png",
"notebooks/images/SHAP2/beeswarm_regular.png"
)
# --- 2. Read Images ---
imgs <- lapply(img_paths, function(path) {
if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
NULL
}
})
# --- 3. Create Individual Plots for Each Image ---
plot_list <- list(
weekly_extreme = ggplot() +
annotation_custom(rasterGrob(imgs[[3]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void(),
weekly_normal = ggplot() +
annotation_custom(rasterGrob(imgs[[4]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void()
)
#| fig-dpi: 300
#| fig-width: 14
#| fig-height: 8
#| warning: false
# --- 1. Define Image Files ---
img_paths <- c(
"notebooks/images/SHAP2/beeswarm_heat.png",
"notebooks/images/SHAP2/beeswarm_regular.png"
)
# --- 2. Read Images ---
imgs <- lapply(img_paths, function(path) {
if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
NULL
}
})
# --- 3. Create Individual Plots for Each Image ---
plot_list <- list(
weekly_extreme = ggplot() +
annotation_custom(rasterGrob(imgs[[1]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void(),
weekly_normal = ggplot() +
annotation_custom(rasterGrob(imgs[[2]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void()
)
# --- 4. Combine Using Patchwork in 2x2 Grid ---
combined_plot <- (plot_list[[1]] | plot_list[[2]]) /
(plot_list[[3]] | plot_list[[4]])
# --- 4. Combine Using Patchwork in 2x2 Grid ---
combined_plot <- (plot_list[[1]] | plot_list[[2]])
# --- 5. Save the Combined Plot ---
ggsave(
filename = "SHAP_beeswarm_facet.png",
plot = combined_plot,
width = 14,
height = 8,
dpi = 300,
units = "in"
)
print(combined_plot)
#| fig-dpi: 300
#| fig-width: 14
#| fig-height: 6
#| warning: false
# --- 1. Define Image Files ---
img_paths <- c(
"notebooks/images/SHAP2/beeswarm_heat.png",
"notebooks/images/SHAP2/beeswarm_regular.png"
)
# --- 2. Read Images ---
imgs <- lapply(img_paths, function(path) {
if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
NULL
}
})
# --- 3. Create Individual Plots for Each Image ---
plot_list <- list(
weekly_extreme = ggplot() +
annotation_custom(rasterGrob(imgs[[1]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void(),
weekly_normal = ggplot() +
annotation_custom(rasterGrob(imgs[[2]], width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
theme_void()
)
# --- 4. Combine Using Patchwork in 2x2 Grid ---
combined_plot <- (plot_list[[1]] | plot_list[[2]])
# --- 5. Save the Combined Plot ---
ggsave(
filename = "SHAP_beeswarm_facet.png",
plot = combined_plot,
width = 14,
height = 6,
dpi = 300,
units = "in"
)
print(combined_plot)
library(ggplot2)
library(png)      # For readPNG
library(grid)     # For rasterGrob
library(patchwork) # For combining plots
# --- 1. Define Image Files ---
# List all 14 image files
img_names <- c(
"AH.png", "BD.png", "KNN_SUBWAY_dist_mean.png", "MEDIAN_INCOME.png",
"NDVI.png", "PCT_BACHELORS_PLUS.png", "PCT_IMPERVIOUS.png", "PCT_LIMITED_ENGLISH.png",
"PCT_NON_WHITE.png", "PCT_RENTERS.png", "PCT_TREE_CANOPY.png",
"POI_500M_DENSITY.png", "POVERTY_RATE.png", "WCR.png"
)
# Construct the full file paths
img_paths <- paste0("notebooks/images/SHAP2/", img_names)
# --- 2. Read Images ---
imgs <- lapply(img_paths, function(path) {
if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
# Return a simple blank grob or a placeholder instead of NULL to maintain list structure
# A simple black rectangle placeholder if the image is missing
return(rasterGrob(matrix(0, 10, 10, dimnames=NULL), width=1, height=1))
}
})
# Filter out actual missing images that returned NULL (if error handling above returned NULL)
# imgs <- Filter(Negate(is.null), imgs)
# --- 3. Create Individual Plots for Each Image ---
# Use the image name as the plot title (strip label)
plot_list <- mapply(function(img, name) {
ggplot() +
# Add the image as a raster graphic filling the entire plot area
annotation_custom(rasterGrob(img, width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
# Add the image file name as the title/label
labs(title = gsub(".png", "", name)) +
theme_void() +
theme(
# Move the title to the top center of the plot panel
plot.title = element_text(hjust = 0.5, size = 10, face = "bold", margin = margin(t = 5, b = 5)),
# Remove any unwanted margins around the image
plot.margin = margin(0, 0, 0, 0, "pt")
)
}, imgs, img_names, SIMPLIFY = FALSE)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(tibble)
library(png)
library(grid)
library(patchwork)
library(ggplot2)
library(png)      # For readPNG
library(grid)     # For rasterGrob
library(patchwork) # For combining plots
# --- 1. Define Image Files ---
# List all 14 image files
img_names <- c(
"AH.png", "BD.png", "KNN_SUBWAY_dist_mean.png", "MEDIAN_INCOME.png",
"NDVI.png", "PCT_BACHELORS_PLUS.png", "PCT_IMPERVIOUS.png", "PCT_LIMITED_ENGLISH.png",
"PCT_NON_WHITE.png", "PCT_RENTERS.png", "PCT_TREE_CANOPY.png",
"POI_500M_DENSITY.png", "POVERTY_RATE.png", "WCR.png"
)
# Construct the full file paths
img_paths <- paste0("notebooks/images/SHAP2/", img_names)
# --- 2. Read Images ---
imgs <- lapply(img_paths, function(path) {
if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
# Return a simple blank grob or a placeholder instead of NULL to maintain list structure
# A simple black rectangle placeholder if the image is missing
return(rasterGrob(matrix(0, 10, 10, dimnames=NULL), width=1, height=1))
}
})
# Filter out actual missing images that returned NULL (if error handling above returned NULL)
# imgs <- Filter(Negate(is.null), imgs)
# --- 3. Create Individual Plots for Each Image ---
# Use the image name as the plot title (strip label)
plot_list <- mapply(function(img, name) {
ggplot() +
# Add the image as a raster graphic filling the entire plot area
annotation_custom(rasterGrob(img, width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
# Add the image file name as the title/label
labs(title = gsub(".png", "", name)) +
theme_void() +
theme(
# Move the title to the top center of the plot panel
plot.title = element_text(hjust = 0.5, size = 10, face = "bold", margin = margin(t = 5, b = 5)),
# Remove any unwanted margins around the image
plot.margin = margin(0, 0, 0, 0, "pt")
)
}, imgs, img_names, SIMPLIFY = FALSE)
library(ggplot2)
library(png)      # For readPNG
library(grid)     # For rasterGrob
library(patchwork) # For combining plots
# --- 1. Define Image Files ---
# List all 14 image files
img_names <- c(
"AH.png", "BD.png", "KNN_SUBWAY_dist_mean.png", "MEDIAN_INCOME.png",
"NDVI.png", "PCT_BACHELORS_PLUS.png", "PCT_IMPERVIOUS.png", "PCT_LIMITED_ENGLISH.png",
"PCT_NON_WHITE.png", "PCT_RENTERS.png", "PCT_TREE_CANOPY.png",
"POI_500M_DENSITY.png", "POVERTY_RATE.png", "WCR.png"
)
# Construct the full file paths
img_paths <- paste0("notebooks/images/SHAP2/shap_scatter_plots_regular", img_names)
# --- 2. Read Images ---
imgs <- lapply(img_paths, function(path) {
if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
# Return a simple blank grob or a placeholder instead of NULL to maintain list structure
# A simple black rectangle placeholder if the image is missing
return(rasterGrob(matrix(0, 10, 10, dimnames=NULL), width=1, height=1))
}
})
# Filter out actual missing images that returned NULL (if error handling above returned NULL)
# imgs <- Filter(Negate(is.null), imgs)
# --- 3. Create Individual Plots for Each Image ---
# Use the image name as the plot title (strip label)
plot_list <- mapply(function(img, name) {
ggplot() +
# Add the image as a raster graphic filling the entire plot area
annotation_custom(rasterGrob(img, width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
# Add the image file name as the title/label
labs(title = gsub(".png", "", name)) +
theme_void() +
theme(
# Move the title to the top center of the plot panel
plot.title = element_text(hjust = 0.5, size = 10, face = "bold", margin = margin(t = 5, b = 5)),
# Remove any unwanted margins around the image
plot.margin = margin(0, 0, 0, 0, "pt")
)
}, imgs, img_names, SIMPLIFY = FALSE)
library(ggplot2)
library(png)      # For readPNG
library(grid)     # For rasterGrob
library(patchwork) # For combining plots
# --- 1. Define Image Files ---
# List all 14 image files
img_names <- c(
"AH.png", "BD.png", "KNN_SUBWAY_dist_mean.png", "MEDIAN_INCOME.png",
"NDVI.png", "PCT_BACHELORS_PLUS.png", "PCT_IMPERVIOUS.png", "PCT_LIMITED_ENGLISH.png",
"PCT_NON_WHITE.png", "PCT_RENTERS.png", "PCT_TREE_CANOPY.png",
"POI_500M_DENSITY.png", "POVERTY_RATE.png", "WCR.png"
)
# Construct the full file paths
img_paths <- paste0("notebooks/images/SHAP2/shap_scatter_plots_regular/", img_names)
# --- 2. Read Images ---
imgs <- lapply(img_paths, function(path) {
if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
# Return a simple blank grob or a placeholder instead of NULL to maintain list structure
# A simple black rectangle placeholder if the image is missing
return(rasterGrob(matrix(0, 10, 10, dimnames=NULL), width=1, height=1))
}
})
# Filter out actual missing images that returned NULL (if error handling above returned NULL)
# imgs <- Filter(Negate(is.null), imgs)
# --- 3. Create Individual Plots for Each Image ---
# Use the image name as the plot title (strip label)
plot_list <- mapply(function(img, name) {
ggplot() +
# Add the image as a raster graphic filling the entire plot area
annotation_custom(rasterGrob(img, width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
# Add the image file name as the title/label
labs(title = gsub(".png", "", name)) +
theme_void() +
theme(
# Move the title to the top center of the plot panel
plot.title = element_text(hjust = 0.5, size = 10, face = "bold", margin = margin(t = 5, b = 5)),
# Remove any unwanted margins around the image
plot.margin = margin(0, 0, 0, 0, "pt")
)
}, imgs, img_names, SIMPLIFY = FALSE)
# --- 4. Combine Using Patchwork in 5-column x 3-row Grid ---
# The wrap_plots() function handles all plots in the list and arranges them
# according to the ncol argument. 14 plots + 1 empty slot = 15 total cells.
combined_plot <- wrap_plots(plot_list, ncol = 5)
print(combined_plot)
print(combined_plot)
print(combined_plot)
print(combined_plot)
print(combined_plot)
# --- 5. Save the Combined Plot ---
# We adjust the height to better accommodate 3 rows (5:3 ratio is 14:8.4)
ggsave(
filename = "SHAP_facet_5x3_grid.png",
plot = combined_plot,
width = 14,
height = 7, # Adjusted height for 3 rows (from 6 to 8.4)
dpi = 300,
units = "in"
)
library(ggplot2)
library(png)      # For readPNG
library(grid)     # For rasterGrob
library(patchwork) # For combining plots
# --- 1. Define Image Files ---
# List all 14 image files
img_names <- c(
"AH.png", "BD.png", "KNN_SUBWAY_dist_mean.png", "MEDIAN_INCOME.png",
"NDVI.png", "PCT_BACHELORS_PLUS.png", "PCT_IMPERVIOUS.png", "PCT_LIMITED_ENGLISH.png",
"PCT_NON_WHITE.png", "PCT_RENTERS.png", "PCT_TREE_CANOPY.png",
"POI_500M_DENSITY.png", "POVERTY_RATE.png", "WCR.png"
)
# Construct the full file paths
img_paths <- paste0("notebooks/images/SHAP2/shap_scatter_plots_heat/", img_names)
# --- 2. Read Images ---
imgs <- lapply(img_paths, function(path) {
if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
# Return a simple blank grob or a placeholder instead of NULL to maintain list structure
# A simple black rectangle placeholder if the image is missing
return(rasterGrob(matrix(0, 10, 10, dimnames=NULL), width=1, height=1))
}
})
# Filter out actual missing images that returned NULL (if error handling above returned NULL)
# imgs <- Filter(Negate(is.null), imgs)
# --- 3. Create Individual Plots for Each Image ---
# Use the image name as the plot title (strip label)
plot_list <- mapply(function(img, name) {
ggplot() +
# Add the image as a raster graphic filling the entire plot area
annotation_custom(rasterGrob(img, width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
# Add the image file name as the title/label
labs(title = gsub(".png", "", name)) +
theme_void() +
theme(
# Move the title to the top center of the plot panel
plot.title = element_text(hjust = 0.5, size = 10, face = "bold", margin = margin(t = 5, b = 5)),
# Remove any unwanted margins around the image
plot.margin = margin(0, 0, 0, 0, "pt")
)
}, imgs, img_names, SIMPLIFY = FALSE)
# --- 4. Combine Using Patchwork in 5-column x 3-row Grid ---
# The wrap_plots() function handles all plots in the list and arranges them
# according to the ncol argument. 14 plots + 1 empty slot = 15 total cells.
combined_plot <- wrap_plots(plot_list, ncol = 5)
print(combined_plot)
# --- 5. Save the Combined Plot ---
# We adjust the height to better accommodate 3 rows (5:3 ratio is 14:8.4)
ggsave(
filename = "SHAP_facet_5x3_grid.png",
plot = combined_plot,
width = 14,
height = 7, # Adjusted height for 3 rows (from 6 to 8.4)
dpi = 300,
units = "in"
)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(tibble)
library(png)
library(grid)
library(patchwork)
library(ggplot2)
library(png)      # For readPNG
library(grid)     # For rasterGrob
library(patchwork) # For combining plots
# --- 1. Define Image Files ---
# List all 14 image files
img_names <- c(
"SHAP_importance_heat.png", "SHAP_importance_regular.png"
)
# Construct the full file paths
img_paths <- paste0("notebooks/images/SHAP2/", img_names)
# --- 2. Read Images ---
imgs <- lapply(img_paths, function(path) {
if (file.exists(path)) {
readPNG(path)
} else {
warning(paste("File not found:", path))
# Return a simple blank grob or a placeholder instead of NULL to maintain list structure
# A simple black rectangle placeholder if the image is missing
return(rasterGrob(matrix(0, 10, 10, dimnames=NULL), width=1, height=1))
}
})
# Filter out actual missing images that returned NULL (if error handling above returned NULL)
# imgs <- Filter(Negate(is.null), imgs)
# --- 3. Create Individual Plots for Each Image ---
# Use the image name as the plot title (strip label)
plot_list <- mapply(function(img, name) {
ggplot() +
# Add the image as a raster graphic filling the entire plot area
annotation_custom(rasterGrob(img, width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
# Add the image file name as the title/label
labs(title = gsub(".png", "", name)) +
theme_void() +
theme(
# Move the title to the top center of the plot panel
plot.title = element_text(hjust = 0.5, size = 10, face = "bold", margin = margin(t = 5, b = 5)),
# Remove any unwanted margins around the image
plot.margin = margin(0, 0, 0, 0, "pt")
)
}, imgs, img_names, SIMPLIFY = FALSE)
# --- 4. Combine Using Patchwork in 5-column x 3-row Grid ---
# The wrap_plots() function handles all plots in the list and arranges them
# according to the ncol argument. 14 plots + 1 empty slot = 15 total cells.
combined_plot <- wrap_plots(plot_list, ncol = 2)
print(combined_plot)
print(combined_plot)
print(combined_plot)
print(combined_plot)
print(combined_plot)
print(combined_plot)
print(combined_plot)
print(combined_plot)
print(combined_plot)
plot_list <- mapply(function(img, name) {
ggplot() +
# Add the image as a raster graphic filling the entire plot area
annotation_custom(rasterGrob(img, width = 1, height = 1),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
# Add the image file name as the title/label
#labs(title = gsub(".png", "", name)) +
theme_void() +
theme(
# Move the title to the top center of the plot panel
plot.title = element_text(hjust = 0.5, size = 10, face = "bold", margin = margin(t = 5, b = 5)),
# Remove any unwanted margins around the image
plot.margin = margin(0, 0, 0, 0, "pt")
)
}, imgs, img_names, SIMPLIFY = FALSE)
# --- 4. Combine Using Patchwork in 5-column x 3-row Grid ---
# The wrap_plots() function handles all plots in the list and arranges them
# according to the ncol argument. 14 plots + 1 empty slot = 15 total cells.
combined_plot <- wrap_plots(plot_list, ncol = 2)
print(combined_plot)
# --- 5. Save the Combined Plot ---
# We adjust the height to better accommodate 3 rows (5:3 ratio is 14:8.4)
ggsave(
filename = "SHAP_bar_facet.png",
plot = combined_plot,
width = 14,
height = 9,
dpi = 300,
units = "in"
)
